

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deep Link Example</title>
</head>
<body>

    <h1>Click the button to open the app</h1>
    <button id="openApp">Open My App</button>
    <p id="result"></p>

    <script>
        document.getElementById('openApp').addEventListener('click', async () => {
            const fallbackURL = 'https://www.google.com';  

            let appOpened = false;

            // Listen for visibility change
            const handleVisibilityChange = () => {
                if (document.visibilityState === 'hidden') {
                    appOpened = true;
                }
            };

            document.addEventListener('visibilitychange', handleVisibilityChange);

            try {
                // Fetch the deep link securely from backend 
                // const response = await fetch('get-deeplink.js');
                // const data = await response.json();

                // if (!data.deepLink) {
                //     throw new Error('Deep link not found');
                // }

                // const appDeepLink = data.deepLink;  // Secure deep link URL

                // Attempt to open the app
                const startTime = Date.now();
                // try{
                //     // window.location.href = "pinfoapp://";
                //     // window.location.href = "https://www.fnx.co.il"; // fnx web
                //     window.location.href = "jonnnnnnnnn://"; 
                
                // }catch (e){
                //     console.warn("Failed to launch ", e);
                // }




                fetch("whatsapp://", { method: 'HEAD' })
                .then(response => {
                    if (response.ok) {
                        // Main URL is accessible, navigate to it
                        window.location.href = "whatsapp://";
                    } else {
                        // Main URL is not accessible, navigate to fallback
                        window.location.href = fallbackUrl;
                    }
                })
                .catch(() => {
                    // An error occurred (e.g., network error), navigate to fallback
                    window.location.href = fallbackUrl;
                });
                

                // Check if app was opened, otherwise redirect to fallback
                setTimeout(() => {
                    const elapsedTime = Date.now() - startTime;
                    if (!appOpened || elapsedTime > 1500) {
                        window.location.href = fallbackURL;
                        console.log("Failed!");
                    }else{
                        console.log("Success!");
                    }

                    document.removeEventListener('visibilitychange', handleVisibilityChange);
                }, 1500);

            } catch (error) {
                console.error('Failed to fetch deep link:', error);
                window.location.href = fallbackURL;  // Fallback if fetch fails
            }
        });
    </script>

</body>
</html>
